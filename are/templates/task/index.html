<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>{{ search['owner'] }} {{ search['tag'] }} ã‚¿ã‚¹ã‚¯</title>
    <style type="text/css">
		* { font-size  : 1em;	}
		p { margin  : 5px;	}
		h2 { margin-bottom  : 0px;	}
		footer { margin-top  : 3em;	}
    </style>
</head>
<body>

<h1><a href="{{ url_for('task.index') }}">ã‚¿ã‚¹ã‚¯</a>
  {%- if search['sort'] == "time" %}
    ç™»éŒ²æ™‚é †
  {%- elif search['sort'] == "update" %}
    æ›´æ–°æ™‚é †
  {%- elif search['sort'] == "cost" %}
    ã‚³ã‚¹ãƒˆé †
  {%- else %}
    é‡è¦åº¦é †
  {%- endif -%}

  {%- if search['cycle'] == "routine" %}
    å®šæœŸ
  {%- elif search['cycle'] == "randomly" %}
    ä¸å®š
  {%- elif search['cycle'] == "none" %}
    å˜ç™º
  {%- else %}
    å…¨ä»¶
  {%- endif -%}

  {%- if search['owner'] %}
    {{ search['owner'] }}
  {%- endif -%}

  {%- if search['cost'] %}
    ã‚³ã‚¹ãƒˆ:{{ search['cost'] }}
  {%- endif -%}

  {%- if search['tag'] %}
    {{ search['tag'] }}
  {%- endif -%}
</h1>

<nav>
    <a href="{{ url_for('task.ownerlist') }}">ä¸€è¦§</a>

    <select name="select" onChange="location.href=value;">
        <option value="#">ã¯ã˜ã‚ã«</option>
        <option value="{{ url_for('task.index', owner='æœª') }}">æœªåˆ†é¡</option>
        <option value="{{ url_for('task.index', rate='0only') }}">æœªè¦åº¦</option>
        <option value="{{ url_for('task.index', cost='0') }}">æœªè¦‹ç©</option>
        <option value="{{ url_for('task.index', owner='æ—¥', rate='5only') }}">æ—¥åˆ</option>
        <option value="{{ url_for('task.index', owner='é€±', rate='5only') }}">é€±åˆ</option>
        <option value="{{ url_for('task.index', owner='æœˆ', rate='5only') }}">æœˆåˆ</option>
    </select>

    <select name="select" onChange="location.href=value;">
        <option value="#">ã‚ˆãä½¿ã†</option>
        <option value="{{ url_for('task.index', cost='1', cycle='none', owner='-è²·') }}">ã™ãã‚„ã‚‹</option>
        <option value="{{ url_for('task.index', owner='è€ƒ') }}">è€ƒ</option>
        <option value="{{ url_for('task.index', owner='æ—¥') }}">æ—¥</option>
        <option value="{{ url_for('task.index', owner='ï½±ï¾š') }}">ï½±ï¾š</option>
        <option value="{{ url_for('task.index', owner='è²·') }}">è²·ã„ç‰©</option>
    </select>

    <select name="select" onChange="location.href=value;">
        <option value="#">ãã®ä»–</option>
        <option value="{{ url_for('task.index', owner='é€±', rate='4') }}">é€±</option>
        <option value="{{ url_for('task.index', owner='æœˆ', rate='4') }}">æœˆ</option>
        <option value="{{ url_for('task.index', owner='åŠæœŸ', rate='4') }}">åŠæœŸ</option>
        <option value="{{ url_for('task.index', owner='å¹´', rate='4') }}">å¹´</option>
        <option value="{{ url_for('task.index', cycle='randomly') }}">ä¸å®šæœŸç¹°è¿”ã—</option>
        <option value="{{ url_for('task.index', owner='å¨¯') }}">å¨¯æ¥½</option>
        <option value="{{ url_for('task.index', owner='ç’°') }}">ç’°å¢ƒæ§‹ç¯‰</option>
        <option value="{{ url_for('task.index', owner='æš®') }}">ç”Ÿæ´»</option>
        <option value="{{ url_for('task.index', owner='èª¿') }}">èª¿ã¹ç‰©</option>
        <option value="{{ url_for('task.index', owner='ä½œ') }}">å‰µä½œ</option>
        <option value="{{ url_for('task.index', tag='æ—¥æ›œ') }}">æ—¥æ›œæ—¥</option>
        <option value="{{ url_for('task.index', tag='æœˆæ›œ') }}">æœˆæ›œæ—¥</option>
        <option value="{{ url_for('task.index', tag='ç«æ›œ') }}">ç«æ›œæ—¥</option>
        <option value="{{ url_for('task.index', tag='æ°´æ›œ') }}">æ°´æ›œæ—¥</option>
        <option value="{{ url_for('task.index', tag='æœ¨æ›œ') }}">æœ¨æ›œæ—¥</option>
        <option value="{{ url_for('task.index', tag='é‡‘æ›œ') }}">é‡‘æ›œæ—¥</option>
        <option value="{{ url_for('task.index', tag='åœŸæ›œ') }}">åœŸæ›œæ—¥</option>
        <option value="#">æ›œæ—¥(æœªå®Ÿè£…)</option>
    </select>

    <br>

  {% if search['sort'] == "time" %}
    <a href="{{ url_for('task.index', change='sort', to='update', **search) }}">æ›´æ–°é †</a>
  {% elif search['sort'] == "update" %}
    <a href="{{ url_for('task.index', change='sort', to='cost', **search) }}">ã‚³ã‚¹ãƒˆé †</a>
  {% elif search['sort'] %}
    <a href="{{ url_for('task.index', change='sort', to='', **search) }}">é‡è¦åº¦é †</a>
  {% else %}
    <a href="{{ url_for('task.index', change='sort', to='time', **search) }}">ç™»éŒ²é †</a>
  {% endif %}

  {% if search['cycle'] == "none" %}
    <a href="{{ url_for('task.index', change='cycle', to='routine', **search) }}">å®šæœŸ</a>
  {% elif search['cycle'] == "routine" %}
    <a href="{{ url_for('task.index', change='cycle', to='randomly', **search) }}">ä¸å®š</a>
  {% elif search['cycle'] == "randomly" %}
    <a href="{{ url_for('task.index', change='cycle', to='', **search) }}">å…¨ã¦</a>
  {% else %}
    <a href="{{ url_for('task.index', change='cycle', to='none', **search) }}">å˜ç™º</a>
  {% endif %}

  {% if search['rate'] == "1only" -%}
    <a href="{{ url_for('task.index', change='rate', to='', **search) }}">â˜…</a>
  {%- else -%}
    <a href="{{ url_for('task.index', change='rate', to='1only', **search) }}">
      {%- if not "only" in search['rate'] and search['rate'] | int >= 1 %}â˜…{% else %}â˜†{% endif -%}
    </a>
  {%- endif -%}
  {%- if search['rate'] == "2only" -%}
    <a href="{{ url_for('task.index', change='rate', to='2', **search) }}">â˜…</a>
  {%- elif search['rate'] == "2" -%}
    <a href="{{ url_for('task.index', change='rate', to='', **search) }}">â˜…</a>
  {%- else -%}
    <a href="{{ url_for('task.index', change='rate', to='2only', **search) }}">
      {%- if not "only" in search['rate'] and search['rate'] | int >= 2 %}â˜…{% else %}â˜†{% endif -%}
    </a>
  {%- endif -%}
  {%- if search['rate'] == "3only" -%}
    <a href="{{ url_for('task.index', change='rate', to='3', **search) }}">â˜…</a>
  {%- elif search['rate'] == "3" -%}
    <a href="{{ url_for('task.index', change='rate', to='', **search) }}">â˜…</a>
  {%- else -%}
    <a href="{{ url_for('task.index', change='rate', to='3only', **search) }}">
      {%- if not "only" in search['rate'] and search['rate'] | int >= 3 %}â˜…{% else %}â˜†{% endif -%}
    </a>
  {%- endif -%}
  {%- if search['rate'] == "4only" -%}
    <a href="{{ url_for('task.index', change='rate', to='4', **search) }}">â˜…</a>
  {%- elif search['rate'] == "4" -%}
    <a href="{{ url_for('task.index', change='rate', to='', **search) }}">â˜…</a>
  {%- else -%}
    <a href="{{ url_for('task.index', change='rate', to='4only', **search) }}">
      {%- if not "only" in search['rate'] and search['rate'] | int >= 4 %}â˜…{% else %}â˜†{% endif -%}
    </a>
  {%- endif -%}
  {%- if search['rate'] == "5only" -%}
    <a href="{{ url_for('task.index', change='rate', to='5', **search) }}">â˜…</a>
  {%- elif search['rate'] == "5" -%}
    <a href="{{ url_for('task.index', change='rate', to='', **search) }}">â˜…</a>
  {%- else -%}
    <a href="{{ url_for('task.index', change='rate', to='5only', **search) }}">
      {%- if not "only" in search['rate'] and search['rate'] | int >= 5 %}â˜…{% else %}â˜†{% endif -%}
    </a>
  {%- endif %}

    <a href="{{ url_for('task.index', change='owner', to='', **search) }}">{{ search['owner'] }}</a>
    <a href="{{ url_for('task.index', change='tag', to='', **search) }}">{{ search['tag'] }}</a>
</nav>

<form method="post" action="{{ url_for('task.create') }}">
    <input name="title" id="title" style="width:100%;" value="{{ request.form['title'] }}" required>
    <input type="submit" value="Save">
    <a href="{{ url_for('task.create', owner=search['owner'], tag=search['tag']) }}">New</a>

    <input type="hidden" name="owner" id="owner" value="{{ search['owner'] }}">
    <input type="hidden" name="tag" id="tag" value="{{ search['tag'] }}">
    <input type="hidden" name="rate" id="rate" value="{{ search['rate'] }}">
    <input type="hidden" name="body" id="body" value="">
    <input type="hidden" name="cost" id="cost" value="{{ search['cost'] }}">
    <input type="hidden" name="sort" id="sort" value="{{ search['sort'] }}">
</form>

<section>
{% for key, value in tasks.items() %}
    <h2>{{ key }}</h2>

  {% for task in value %}
    <div>
      {% if task['çŠ¶æ…‹'] == 'å®Œ' %}
        <a href="{{ url_for('task.restore', number=task['é€£ç•ª'], **search) }}">â˜‘</a>
      {% elif task['çŠ¶æ…‹'] == 'æœª' %}
        <a href="{{ url_for('task.done', number=task['é€£ç•ª'], **search) }}">â˜</a>
      {% elif task['çŠ¶æ…‹'] == 'ï¼' %}
        <a href="{{ url_for('task.done', number=task['é€£ç•ª'], **search) }}">â˜</a>
        <span style="font-size  : 0.5em;">{{ task['å¤‰æ›´æ—¥æ™‚'] | jptime}}</span>
      {% else %}
        <span style="font-size  : 0.5em;">{{ task['å¤‰æ›´æ—¥æ™‚'] | jptime}}</span>
      {% endif %}

      {% if task['å®Œäº†æ—¥æ™‚'] %}
        <span style="font-size  : 0.5em;">{{ task['utcP9time']}}</span>
        äºˆ{{ task['ã‚³ã‚¹ãƒˆ'] }}
        <a href="{{ url_for('task.costup', number=task['é€£ç•ª'], **search) }}">å®Ÿ{{ task['å®Ÿã‚³ã‚¹ãƒˆ'] }}</a>
      {% else %}

        {% if task['é‡è¦åº¦'] == 1 -%}
          <a href="{{ url_for('task.rateto', number=task['é€£ç•ª'], change=0, **search) }}">â˜…</a>
        {%- else -%}
          <a href="{{ url_for('task.rateto', number=task['é€£ç•ª'], change=1, **search) }}">
          {%- if task['é‡è¦åº¦'] > 0 %}â˜…{% else %}â˜†{% endif -%}
          </a>
        {%- endif -%}
          <a href="{{ url_for('task.rateto', number=task['é€£ç•ª'], change=2, **search) }}">
            {%- if task['é‡è¦åº¦'] > 1 %}â˜…{% else %}â˜†{% endif -%}
          </a><a href="{{ url_for('task.rateto', number=task['é€£ç•ª'], change=3, **search) }}">
            {%- if task['é‡è¦åº¦'] > 2%}â˜…{% else %}â˜†{% endif -%}
          </a><a href="{{ url_for('task.rateto', number=task['é€£ç•ª'], change=4, **search) }}">
            {%- if task['é‡è¦åº¦'] > 3 %}â˜…{% else %}â˜†{% endif -%}
          </a><a href="{{ url_for('task.rateto', number=task['é€£ç•ª'], change=5, **search) }}">
            {%- if task['é‡è¦åº¦'] > 4 %}â˜…{% else %}â˜†{% endif -%}
          </a>
          <a href="{{ url_for('task.costup', number=task['é€£ç•ª'], **search) }}">{{ task['ã‚³ã‚¹ãƒˆ'] }}</a>
      {%- endif %}
        :
        <a href="{{ url_for('task.index', change='owner', to=task['æ‰€æœ‰è€…'], **search) }}">{{ task['æ‰€æœ‰è€…'] }}</a>
        {{ task['ã‚¿ã‚¹ã‚¯å'] }}{% if task['å‚™è€ƒ'] %} â€» {% endif %}
      {% for tag in tags[task['é€£ç•ª']] %}
        <a href="{{ url_for('task.index', change='tag', to=tag, **search) }}" style="font-size  : 0.6em">{{ tag }}</a>
      {% endfor %}
        <a style="font-size  : 0.8em;" href="{{ url_for('task.update', number=task['é€£ç•ª'], **search) }}">ğŸ“</a>

    </div>
  {% endfor %}
{% endfor %}
</section>


<footer>
  {% if g.user %}
    <span>{{ g.user['username'] }}</span>
    <a href="{{ url_for('auth.logout') }}">Log Out</a>
  {% else %}
    <a href="{{ url_for('auth.register') }}">Register</a>
    <a href="{{ url_for('auth.login') }}">Log In</a>
  {% endif %}
</footer>

</body>
</html>
